"use strict";goog.provide("Blockly.Arduino.HAODA_MIDI"),goog.require("Blockly.Arduino"),Blockly.Arduino.haoda_midi_diacritical=Blockly.Arduino.haoda_midi_scale=Blockly.Arduino.haoda_midi_timbre_percussion=Blockly.Arduino.haoda_midi_timbre=Blockly.Arduino.haoda_midi_channel=function(block){var code;return[block.getFieldValue("value"),Blockly.Arduino.ORDER_ATOMIC]},Blockly.Arduino.haoda_midi_send=function(block){Blockly.Arduino.definitions_.include_haoda='#include "HAODA_MIDI.h"';var dropdown_io=Blockly.Arduino.valueToCode(block,"port",Blockly.Arduino.ORDER_ATOMIC);Blockly.Arduino.definitions_["HD_MIDI"+dropdown_io]="HD_MIDI midi_"+dropdown_io+"("+dropdown_io+");";var channel=Blockly.Arduino.valueToCode(block,"channel",Blockly.Arduino.ORDER_NONE),scale=Blockly.Arduino.valueToCode(block,"scale",Blockly.Arduino.ORDER_NONE),diacritical=Blockly.Arduino.valueToCode(block,"diacritical",Blockly.Arduino.ORDER_NONE),vol=Blockly.Arduino.valueToCode(block,"vol",Blockly.Arduino.ORDER_NONE),code;if(channel.match(/^-?\d+$/)?(channel>15?channel=15:channel<0&&(channel=0),channel="0x9"+parseInt(channel,10).toString(16)):channel="0x90+"+channel,scale.match(/^-?\d+$/)&&diacritical.match(/^-?\d+$/)){scale>9?scale=9:scale<-1&&(scale=-1),diacritical>11?diacritical=11:diacritical<0&&(diacritical=0);var note=12*(parseInt(scale,10)+1)+parseInt(diacritical,10);note="0x"+parseInt(note,10).toString(16)}else if(scale.match(/^-?\d+$/)){scale>9?scale=9:scale<-1&&(scale=-1);var note="0x"+(12*(parseInt(scale,10)+1)).toString(16)+"+"+diacritical}else if(diacritical.match(/^-?\d+$/)){diacritical>11?diacritical=11:diacritical<0&&(diacritical=0);var note="("+scale+"+1)*0xc+"+parseInt(diacritical,10)}else var note="("+scale+"+1)*0xc+0x"+diacritical.toString(16);return vol.match(/^-?\d+$/)&&(vol>127?vol=127:vol<0&&(vol=0),vol="0x"+parseInt(vol,10).toString(16)),"midi_"+dropdown_io+".Send("+channel+","+note+","+vol+");\n"},Blockly.Arduino.haoda_midi_set_ins_type=function(block){Blockly.Arduino.definitions_.include_haoda='#include "HAODA_MIDI.h"';var dropdown_io=Blockly.Arduino.valueToCode(block,"port",Blockly.Arduino.ORDER_ATOMIC);Blockly.Arduino.definitions_["HD_MIDI"+dropdown_io]="HD_MIDI midi_"+dropdown_io+"("+dropdown_io+");";var channel=Blockly.Arduino.valueToCode(block,"channel",Blockly.Arduino.ORDER_NONE),type=Blockly.Arduino.valueToCode(block,"type",Blockly.Arduino.ORDER_NONE),code;return channel.match(/^-?\d+$/)?(channel>15?channel=15:channel<0&&(channel=0),channel="0xc"+parseInt(channel,10).toString(16)):channel="0xc0+"+channel,type.match(/^-?\d+\.?\d*$/)&&(type>127?type=127:type<0&&(type=0),type="0x"+parseInt(type,10).toString(16)),"midi_"+dropdown_io+".Send("+channel+","+type+","+type+");\n"},Blockly.Arduino.haoda_midi_send_percussion=function(block){Blockly.Arduino.definitions_.include_haoda='#include "HAODA_MIDI.h"';var dropdown_io=Blockly.Arduino.valueToCode(block,"port",Blockly.Arduino.ORDER_ATOMIC);Blockly.Arduino.definitions_["HD_MIDI"+dropdown_io]="HD_MIDI midi_"+dropdown_io+"("+dropdown_io+");";var type=Blockly.Arduino.valueToCode(block,"type",Blockly.Arduino.ORDER_NONE),vol=Blockly.Arduino.valueToCode(block,"vol",Blockly.Arduino.ORDER_NONE),code;return type.match(/^-?\d+$/)&&(type>127?type=127:type<0&&(type=0),type="0x"+parseInt(type,10).toString(16)),vol.match(/^-?\d+$/)&&(vol>127?vol=127:vol<0&&(vol=0),vol="0x"+parseInt(vol,10).toString(16)),"midi_"+dropdown_io+".Send(0x99,"+type+","+vol+");\n"};